---
output: github_document
---



```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)

```
# butteR


butteR can be used to smooth out the analysis and visualization of spatial survey data collected using odk. ButteR mainly consists of convenient wrappers and pipelines for the survey, srvyr, sf, and rtree packages.

## Installation

You can install the the development version from [GitHub](https://github.com/) with:


``` {r, eval=FALSE}
# install.packages("devtools")
devtools::install_github("zackarno/butteR")
## Example
```


### Example using the stratified sampler function

First I will make a fake data set and sample frame

```{r example}
library(butteR)
library(dplyr)
lon<-runif(min=88.00863,max=92.68031, n=100)
lat<-runif(min=20.59061,max=26.63451, n=100)
strata_options<-LETTERS[1:8]

#make a simulated dataset
pt_data<-data.frame(lon=lon, lat=lat, strata=sample(strata_options,1000, replace=TRUE))
sample_frame<-data.frame(strata=strata_options,sample_size=round(runif(10,100,n=8),0))
```


Here are the first six rows of data for the sample frame and data set

````{r}
pt_data %>% head() %>% knitr::kable()
sample_frame %>% head() %>% knitr::kable()
```


Next we will produce the stratified sample. Y

ou can check the function help file by typing ?stratified_sampler. If you want the samples writtent to kmz you will need to change write_kml to FALSE.


```{r}
?butteR::stratified_sampler


sampler_ouput<-butteR::stratified_sampler(sample.target.frame = sample_frame, 
                           sample.target.frame.strata = "strata",
                           sample.target.frame.samp.size = "sample_size",pt.data =pt_data,
                           pt.data.strata = "strata",pt.data.labels = "strata" ,write_kml = FALSE,target_gdb = 
                            )

```

The output is stored in a list. Below is the first 6 results of each stratified sample. The results are stratified sample. They can be viewed collectively or one at a time.

```{r}
sampler_ouput$results %>% purrr:::map(head) %>% knitr::kable()


sampler_ouput$results$D %>% head()

````
  
The random_seed is saved in the list as well as an attribute of each stratified sample. The random seed is very important for reproducibility which is quite useful for subsequent rounds of data collection

```{r}
sampler_ouput$random_seed 
```

You can also view all of the remaining points which were not not randomly sampled. You can choose to have these written to a shape file. It is generally a good back up policy to write these as well.

```{r}

sampler_ouput$samp_remaining %>% head() %>% knitr::kable()
```
  
  

